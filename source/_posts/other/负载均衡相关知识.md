## 会话保持和长连接

* 会话保持：指连接断开，在规定时间内再次连接的时候，保证路由到同一服务器。

* 长连接：在keep-alive状态下，也是会路由到同一服务的。会话不保持的话，连接断开，再次连接的时候，会重新进行服器路由。

## TCP四层负载均衡

> 负载均衡设备在接收到第一个来自客户端的 `SYN` 请求时，即通过上述方式选择一个最佳的服务器，并对报文中目标IP地址进行修改（改为后端服务器IP），直接转发给该服务器。TCP的连接建立，即三次握手是**客户端**和**服务器**直接建立的，负载均衡设备只是起到一个类似路由器的转发动作。在某些部署情况下，为保证服务器回包可以正确返回给负载均衡设备，在转发报文的同时可能还会对报文原来的源地址进行修改。

## TCP七层负载均衡

> 负载均衡设备先代替服务器和客户端建立连接(三次握手)后，才可能接受到客户端发送的真正应用层内容的报文，然后再根据该报文中的特定字段，再加上负载均衡设备设置的服务器选择方式，决定最终选择的内部服务器。负载均衡设备在这种情况下，更类似于一个代理服务器。负载均衡和前端的客户端以及后端的服务器会分别建立TCP连接。

## 七层模型

* 物理层
* 数据链路层
* 网络层: IP
* 传输层: TCP/UDP, 注意：端口号在本层使用
* 会话层: RPC
* 表示层: SSL/TLS
* 应用层: HTTP

## 相关文章

负载均衡模式(https://blog.crazytaxii.com/posts/modern_network_load_balancing_and_proxying2/)

Http的keep-alive和TCP的keepalive(https://zhuanlan.zhihu.com/p/224595048?hmsr=toutiao.io)